<!DOCTYPE html>
<html>
    <head>
        <title>Oculus API App Versions</title>
        <meta property="og:site_name" content="ComputerElite">
        <meta property="og:title" content="Oculus API App Versions" />
        <meta property="og:description" content="A page to get downloads for various Oculus apps" />
        <meta property="og:url" content="https://computerelite.github.io/tools/Oculus/AppVersions.html" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700,700italic' rel='stylesheet' type='text/css'>
        <link href="../../css/standard.css" type="text/css" rel="stylesheet">
        <link rel="icon" href="../../assets/CE_64px.png" type="image/x-icon">
        <style>
            td {
                padding: 10px;
            }

            html {
                background-color: #111111;
            }

            .item {
                flex: 1;
                width: 25%;
                word-wrap: break-word;
                padding: 3px;
            }

            hr {
                border-color: #2c2c2c;
            }

            .coolimg {
                max-width: 85vw;
                height: auto;
                width: 500px;
            }
        </style>
    </head>
    <body onmousemove="UpdateMousePos(event)">
        <div style="flex: 1; padding: 10px;" class="bigBox">
            <div style="font-size: 24px; text-align: center;">Oculus API App Versions</div>
            <div style="font-size: 15px; text-align: center; color: #888;">
                Get download links for all Oculus apps
            </div>

            <table style="padding: 10px; margin: auto; margin-top: 40px;">
                <tr>
                    <td style="display: flex; flex-wrap: wrap;">
                        <div style="margin-left: 87px;" class="marginlow">Headset</div>
                        <select id="headset" class="marginlow">
                            <option value="MONTEREY">Quest</option>
                            <option value="PACIFIC">Go</option>
                            <option value="GEARVR">GearVR</option>
                            <option value="RIFT">Rift (downloads working via seperate program)</option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td style="display: flex; flex-wrap: wrap; align-items: center;">
                        <div class="marginlow">Search term for app</div>
                        <input type="text" class="marginlow" style="width: auto; min-width: 20vw; max-width: 90vw;" value="Beat Saber" id="searchTerm" spellcheck="false" onkeydown='if(event.keyCode == 13) Search()'>
                        <input type="button" class="marginlow" value="Search" onclick="Search()">
                    </td>
                </tr>
            </table>
            <div style="position: fixed; width: 100vw; height: 100vh; display: flex; align-items: center; justify-content: center; background-color: #00000099; visibility: hidden; top: 0; left: 0" id="popupContainer" onclick="if(event.target.id == 'popupContainer') document.getElementById('popupContainer').style.visibility = 'hidden'">
                <div style="background-color: #222222; padding: 10px;">
                    <div style="display: flex; justify-content: center; flex-direction: column; align-items: center;" id="popup">
                        
                    </div>
                </div>
            </div>
            <div id="notesContainer" style="margin-bottom: 50px;">

            </div>
            <div id="resultContainer">
                <div style="display: flex; flex-wrap: wrap;">
                    <div style="flex: 1; font-size: 18px; padding: 5px; margin: 5px;">
                        <table style="width: fit-content; margin: auto;">
                            <tr><td><img src="../../assets/CE_512px.png" width="100px" height="100px"></td><td>Please search</td></tr>
                        </table>
                    </div>
                </div>
            </div>

            <div id="contextMenu" class="contextMenu">
                <div class="contextMenuItem" onclick="navigator.clipboard.writeText(forClipboard)">Copy id</div>
                <div class="contextMenuItem" onclick="SetClipboardLink()">Copy link</div>
            </div>
            <div id="tooltip" class="tooltip">
                tooltip
            </div>
            <div class="tip" style="margin-top: 20px; width: fit-content;">
                <div class="tipHeader">
                    Help. When I try to downgrade I get <code>Error the site could not be found</code>
                </div>
                If you get an Error saying <code>Error the site could not be found</code> then you're most likely not logged in on <a href="https://www.oculus.com/">oculus.com</a> (in this browser). If you are 100% sure you own the app and are signed in try a different browser like Microsoft Edge or Firefox. Otherwise you don't own the app you're trying to download.
            </div>
            <div class="guideHeader">How do I use this?</div>
            <div class="guideSteps" id="instructions">
                Log in on <a href="https://www.oculus.com/">oculus.com</a>, search for an app, click on it, click on the version your want to download and you got yourself an apk you can install.
                <br>
                Alternatively you can watch <a href="https://www.youtube.com/watch?v=PU75xnFAyHY&t=321s">this video guide by Cas and Chary VR</a>. But make sure you have devloper mode enabled as this is a requirement to install apps.
            </div>
            <div class="guideHeader">Is this legal?</div>
            <div class="guideSteps">
                I cannot give an 100% correct answer on that. But it uses Oculus public API and official download servers (for which you need to own the app and be logged in on <a href="https://www.oculus.com/">oculus.com</a> to download the app) to get all the information.
                <br/>
                So if you ask me I'd say yes, it is legal.
            </div>
            <br/>
            <div class="attention" style="margin-top: 20px; width: fit-content; font-size: 14px;">
                <div class="attentionHeader" style="font-size: 16px;">
                    The APK fails to install on Sidequest and says <code>SAFESIDE</code> or is stuck on <code>Checking APK against blacklist</code>
                </div>
                <br>Download <code>MultiUserADBInterface.zip</code> from <a href="https://github.com/ComputerElite/MultiUserADBInterface/releases/latest">here</a>. Then unzip the file you downloaded (right click -> extract all). After that's done open the MultiUserADBInterface executable and type in <code>1</code> followed by enter to install an apk. Then drag and drop the apk on which you got the error when installing with Sidequest into the window and press enter. Finally select the User you want to install the apk and you're done.
                <br>
                <br><i>do all of this while your quest is plugged in. If you have any issues feel free to ask</i>
                <br>
                <br>Note: This will <b>not</b> make Sidequest able to install the APK. It'll install the APK without Sidequest
            </div>
            <div class="attention" style="margin-top: 20px; width: fit-content; font-size: 14px;">
                <div class="attentionHeader" style="font-size: 16px;">
                    What to do when getting <code>An Error occured</code>
                </div>
                    Try again in 10 minutes or so. If the issue still persists contact ComputerElite via Discord.
            </div>
            <div class="tip" style="margin-top: 20px; width: fit-content;">
                <div class="tipHeader">
                    How might I be able to download obb files?
                </div>
                It's a bit tricky. First you need to follow <a href="ObtainToken.html">this guide</a> to obtain your access_token. Then on this site press F12 and go into the <code>console</code> tab. In there write <code>access_token = "YourToken"</code> where you replace <code>YourToken</code> with the token you obtained by following the guide. Then hit enter and select any app version you want do download. If obb files are needed there's a good chance they'll download. However if they don't then you can use <a href="https://github.com/ComputerElite/Rift-downgrader">Rift Downgrader</a> to download both the apkand obb files.<br>
                Note: You'll have to do this every time you reload the site
            </div>
            <div class="tip" style="margin-top: 20px; width: fit-content;">
                <div class="tipHeader">
                    Why do I get <code>Request to Oculus failed</code>
                </div>
                This is not your fault. This shown up when my proxy server (which makes you able to do requests to Oculus) is shut down. Currently it has reached the maximum runtime for this month. While this happens all cached data will be used so you can continue to use this site.
            </div>
            <div style="text-align: center; font-size: 11px; color: #888;">
                API found by nyamimi, requests found by Lillie, page by ComputerElite
            </div>
        </div>
        <script src="../../js/standard.js"></script>
        <script src="../../js/jszip.js"></script>
        <script>
            var menu = document.getElementById("contextMenu")
            var progressBar = document.getElementById("progressBar")
            var progressText = document.getElementById("file")
            var tooltip = document.getElementById("tooltip")
            var showingVersions = false
            var showedid = ""
            var requestUrl = "https://cors-anywhere-computerelite.herokuapp.com/https://graph.oculus.com/graphql"
            //var setDNT = "1"
            const versionSkeleton = `<div style="font-size: 22px; text-align: center; font-weight: bold;" id="versionHeader">Versions</div>
                    <div style="font-size: 18px; color: #EEEEEE; text-align: center; display: flex; justify-content: center; width: 100%;">
                        <div class="item">Version</div>
                        <div class="item">Changelog</div>
                        <div class="item">id</div>
                    </div>
                    <div id="versions" style="display: flex; color: #EEEEEE; width: 100%; justify-content: space-evenly; flex-direction: column;">
                    </div>
                    
                    <div style="font-size: 22px; text-align: center; font-weight: bold;" id="dlcsHeader">DLCs</div>
                    <div style="display: flex; flex-wrap: wrap;" id="dlcs">
                    </div>`
            const storeSkeleton =  `<div style="display: flex; flex-wrap: wrap; justify-content: flex-start;" id="apps">
                                    </div>
                                    <div id="appsinfo" style="font-size: 22px; text-align: center; font-weight: bold;">
                                    </div>`

            const loader = `<div class="loader" style="width: 50px; height: 50px; margin: auto;"></div>`
            const ErrorMSG = `<div style='font-size: 24px; text-align: center; flex: 1;'>An error occured. Check below for more info</div>`
            const RequestFailedError = `<div class="tip" style="margin-top: 20px; width: fit-content; margin-bottom: 20px;">
                                            <div class="tipHeader">
                                                Why do I get <code>Request to Oculus failed</code>
                                            </div>
                                            This is not your fault. This shown up when my proxy server (which makes you able to do requests to Oculus) is shut down. Currently it has reached the maximum runtime for this month. While this happens all cached data will be used so you can continue to use this site.
                                        </div>`
            var access_token = "OC|1317831034909742|"

            var url = new URL(window.location.href);
            var id = url.searchParams.get("id");
            var query = url.searchParams.get("query");
            var downloadId = url.searchParams.get("downloadid");
            var downloadVersion = url.searchParams.get("downloadversion");

            if(id) {
                SearchVersions(id)
            }
            if(query) {
                document.getElementById("searchTerm").value = query
                Search(query)
            }
            if(downloadId) {
                setTimeout(() => {
                    var a = document.createElement("a")
                    a.href = GetDownloadLink(downloadId)
                    a.target = "_blank"
                    a.click()
                }, 100)
            }
            if(downloadVersion) {
                if(!id)
                {
                    downloadVersion = ""    
                    alert("id query parameter must be set to an app")
                } else {
                    SearchVersions(id)
                }
            }

            var menuOpen = false;

            document.onclick = (e) => {
                menu.style.display = "none"
            }

            var forClipboard = ""
            var isVersion = false;

            function SetClipboardLink() {
                navigator.clipboard.writeText(isVersion ? GetDownloadLink(forClipboard) : window.location.href.split('?')[0] + "?id=" + forClipboard)
            }

            function SetupContextMenu(e, id, version) {
                if(menuOpen && forClipboard == id) {
                    menuOpen = false
                    menu.style.display = "none"
                } else {
                    isVersion = version
                    forClipboard = id
                    menuOpen = true
                    menu.style.display = "block"
                    menu.style.top = mouseY(event) + 'px';  
                    menu.style.left = mouseX(event) + 'px';
                    return false
                }
                
            }

            var x = 0
            var y = 0
            var inElement = false
            var lastText = "";
            function ShowTooltip(e, text) {
                inElement = true;
                lastText = text
                mouseX(e)
                setTimeout(() => {
                    if(inElement && lastText == text) {
                        tooltip.innerHTML = text
                        tooltip.style.display = "block"
                        tooltip.style.top = y + 'px';  
                        tooltip.style.left = (x + 15) + 'px';
                    }
                }, 500)
            }

            function UpdateMousePos(e) {
                x = mouseX(e)
                y = mouseY(e)
            }

            function HideTooltip(e, text) {
                inElement = false;
                tooltip.style.display = "none"
            }

            function Search(searchTerm = undefined) {
                document.getElementById("notesContainer").innerHTML = "";
                showingVersions = false;
                document.getElementById("resultContainer").innerHTML = storeSkeleton
                document.getElementById("apps").innerHTML = loader
                if(searchTerm == undefined) searchTerm = document.getElementById("searchTerm").value
                var added = []
                PostRequest(requestUrl, `access_token=${access_token}&variables={"query":"${searchTerm}","hmdType":"${document.getElementById("headset").value}","firstSearchResultItems":100}&doc_id=3928907833885295`).then((res) => {
                    /*
                    document.getElementById("apps").innerHTML = ""
                    res.data.application_search.results.edges.forEach(element => {
                            document.getElementById("apps").innerHTML += GetResultFormatted({
                                imgsrc: element.node.cover_square_image.uri,
                                name: element.node.display_name,
                                id: element.node.id
                            })
                    })
                    if(document.getElementById("apps").innerHTML == "") {
                        document.getElementById("apps").innerHTML = "<div style='font-size: 24px; text-align: center; flex: 1;'>Nothing found</div>"
                    }
                    */
                    document.getElementById("apps").innerHTML = ""
                    res.data.viewer.contextual_search.all_category_results.forEach(cat => {
                        if(cat.name == "APPS" || cat.name == "CONCEPT") {
                            cat.search_results.nodes.forEach(element => {
                                if(added.includes(element.target_object.id)) return
                                added.push(element.target_object.id)
                                document.getElementById("apps").innerHTML += GetResultFormatted({
                                    imgsrc: element.target_object.cover_landscape_image.uri,
                                    name: element.target_object.display_name,
                                    id: element.target_object.id
                                })
                            })
                        }
                    })
                    MakeJSONGetRequestAsync("OlderAppVersions/index.json").then(res => {
                        res.forEach(element => {
                            if(element.headset != document.getElementById("headset").value || !element.name.toLowerCase().includes(searchTerm.toLowerCase())) return
                                if(added.includes(element.id)) return
                                added.push(element.id)
                                document.getElementById("apps").innerHTML += GetResultFormatted({
                                    imgsrc: element.img,
                                    name: element.name,
                                    id: element.id
                                })
                            })
                        if(document.getElementById("apps").innerHTML == "") {
                            document.getElementById("apps").innerHTML = "<div style='font-size: 24px; text-align: center; flex: 1;'>Nothing found</div>"
                        }
                    })
                    
                }).catch(err => {
                    MakeJSONGetRequestAsync("OlderAppVersions/index.json").then(res => {
                        document.getElementById("appsinfo").innerHTML = `<div>Request to Oculus failed. <i>(Basic)</i> Search has run on cached apps</div>` + RequestFailedError
                        document.getElementById("apps").innerHTML = ""
                        res.forEach(element => {
                            if(added.includes(element.id)) return
                            added.push(element.id)
                            if(element.headset != document.getElementById("headset").value || !element.name.toLowerCase().includes(searchTerm.toLowerCase())) return
                                document.getElementById("apps").innerHTML += GetResultFormatted({
                                    imgsrc: element.img,
                                    name: element.name,
                                    id: element.id
                                })
                            })
                    }).catch(err => {
                        document.getElementById("apps").innerHTML = ErrorMSG
                    })
                    ReportIssue()
                })
            }

            function GetDownloadLink(id) {
                return "https://securecdn.oculus.com/binaries/download/?id=" + id
            }

            var versions = []
            var finished = 0
            var required = 3;
            var failed = false

            function SearchVersions(id) {
                var headset = document.getElementById("headset").value
                failed = false
                document.getElementById("notesContainer").innerHTML = "";
                showedid = id
                showingVersions = true;
                document.getElementById("resultContainer").innerHTML = versionSkeleton
                document.getElementById("versions").innerHTML = loader
                document.getElementById("dlcs").innerHTML = loader
                versions = []
                finished = 0
                required = 3
                var loop = setInterval(() => {
                        //////CACHE
                        if(finished == required - 1) {
                            MakeJSONGetRequestAsync("OlderAppVersions/index.json").then(res => {
                                var contained = false
                                for(let i = 0; i < res.length; i++)
                                {
                                    if(res[i].id == id) {
                                        contained = true
                                        break;
                                    }
                                }
                                if(contained) {
                                    console.log("Requesting cached data for " + id)
                                    MakeJSONGetRequestAsync(`OlderAppVersions/${id}.json`).then(res => {
                                        if(failed) document.getElementById("versionHeader").innerHTML = "Versions for " + res.data.node.appName
                                        res.data.node.binaries.edges.forEach(element => {
                                            var contained = false;
                                            versions.forEach(e => {
                                                if(e.id == element.node.id) {
                                                    contained = true;
                                                }
                                            })
                                            if(!contained) {
                                                versions.push({
                                                    version: element.node.version,
                                                    changelog: element.node.change_log,
                                                    id: element.node.id,
                                                    code: element.node.version_code,
                                                    channelname: "From cache",
                                                    createdate: element.node.created_date,
                                                    appid: id
                                                })
                                            }
                                        })
                                        UpdateVersions(true, headset)
                                    })
                                } else {
                                    UpdateVersions(true, headset)
                                }
                            }).catch(err => UpdateVersions(true, headset))
                            clearInterval(loop)
                        } else {
                            console.log("Delaying cache request until remaining completed")
                        }
                    }, 10)
                PostRequest(requestUrl, `access_token=${access_token}&variables={"id":"${id}"}&doc_id=1586217024733717`).then((res) => {
                    res.data.node.supportedBinaries.edges.forEach(element => {
                        versions.push({
                            version: element.node.version,
                            changelog: element.node.changeLog,
                            id: element.node.id,
                            code: element.node.versionCode,
                            channelname: "From cache",
                            createdate: 0,
                            appid: id
                        })
                    })
                    document.getElementById("versionHeader").innerHTML = "Versions for " + res.data.node.displayName

                    //////BETA
                    console.log("Adding betas")
                    PostRequest(requestUrl, `access_token=OC|1317831034909742|&variables={"itemId":"${id}","first":5,"last":null,"after":null,"before":null,"forward":true,"ordering":null,"ratingScores":null,"hmdType":"MONTEREY" }&doc_id=5373392672732392`).then((res) => {
                        res.data.node.release_channels.nodes.forEach(element => {
                            var contained = false;
                            versions.forEach(e => {
                                if(e.id == element.latest_supported_binary.id) {
                                    contained = true;
                                }
                            })
                            if(!contained) {
                                versions.unshift({
                                    version: "[" + element.channel_name + "] " + element.latest_supported_binary.version,
                                    changelog: "Changelog not available",
                                    id: element.latest_supported_binary.id,
                                    code: element.latest_supported_binary.versionCode,
                                    appid: id
                                })
                            }
                        })
                        UpdateVersions(true, headset)
                    }).catch(err => UpdateVersions(true, headset))
                   UpdateVersions(true, headset)
                }).catch(err => {
                    document.getElementById("versions").innerHTML = ErrorMSG
                    console.log(err)
                    failed = true
                    finished = required - 1
                    ReportIssue()
                })
                var dlcs = document.getElementById("dlcs")
                PostRequest(requestUrl, `access_token=${access_token}&variables={"id":"${id}","first": 100}&doc_id=3998937106836519`).then((res) => {
                    dlcs.innerHTML = ""
                    res.data.node.latest_supported_binary.firstIapItems.edges.forEach(dlc => {
                        if(dlc.node.latest_supported_asset_file != undefined) {
                            dlcs.innerHTML += GetDlcFormatted({
                                id: dlc.node.latest_supported_asset_file.id,
                                name: dlc.node.display_name
                            }, headset == "RIFT")
                        }
                        
                    })
                    if(dlcs.innerHTML == "") dlcs.innerHTML = "<div style='flex:1;'>None</div>"
                }).catch(err => {
                    dlcs.innerHTML = `<div style="font-size: 22px; text-align: center; font-weight: bold; width: 100%; margin-bottom: 30px;">Request to Oculus failed. DLCs haven't been cached</div>`
                })

                //BETA
                /*
                PostRequest("https://cors-anywhere-computerelite.herokuapp.com/https://graph.oculus.com/graphql", `access_token=${access_token}&variables={"itemId":"${id}","first":5,"last":null,"after":null,"before":null,"forward":true,"ordering":null,"ratingScores":null,"hmdType":"MONTEREY" }&doc_id=5373392672732392`).then((res) => {
                    res.data.node.release_channels.nodes.forEach(element => {
                        var contained = false;
                        console.log(element.channel_name)
                        versions.forEach(e => {
                            if(e.id == element.latest_supported_binary.id) {
                                contained = true;
                            }
                        })
                        if(!contained) {
                            versions.push({
                                version: element.latest_supported_binary.version,
                                changelog: "N/A build from " + element.channel_name,
                                id: element.latest_supported_binary.id,
                                code: element.node.versionCode,
                                channelname: element.channel_name,
                                createdate: 0
                            })
                        }
                    })
                    UpdateVersions(true, headset)
                }).catch(err => UpdateVersions(true, headset))
                */


                //Request extra app info
                MakeJSONGetRequestAsync("AppNotes/index.json").then(res => {
                    if(res.includes(id)) {
                        MakeTextGetRequestAsync(`AppNotes/${id}.html`).then(res => {
                            document.getElementById("notesContainer").innerHTML = res
                            Array.prototype.forEach.call(document.getElementById("notesContainer").getElementsByTagName("script"), e => {
                                console.log(e)
                                s = document.createElement("script")
                                s.innerHTML = e.innerHTML
                                document.head.appendChild(s)
                            })
                            
                        })
                    }
                })
            }

            function SortByVersion(versions) {
                var outp = []
                var c = {}
                var ite = versions.length
                for(let it = 0; it < ite; it++) {
                    c = versions[0]
                    var ci = 0
                    for(let i = 0; i < versions.length; i++) {
                        try {
                            if(c.code > versions[i].code) {
                                c = versions[i]
                                ci = i
                            }
                        } catch (err) {console.log(err)}
                    }
                    versions.splice(ci, 1)
                    outp.unshift(c)
                }
                return outp
            }

            function UpdateVersions(add = true, HeadsetName) {
                if(add) finished++
                console.log(finished + " out of " + required + " tasks finished")
                versions = SortByVersion(versions)
                document.getElementById("versions").innerHTML = finished < required ? loader : ""
                versions.forEach(e => {
                    document.getElementById("versions").innerHTML += GetFormatted(e, HeadsetName == "RIFT")
                    if(finished >= required && downloadVersion && e.version == downloadVersion) {
                        name = document.getElementById("versionHeader").innerHTML.replace("Versions for ", "")
                        /*
                        if(confirm("Do you want to Download " + name + " version " + downloadVersion)){
                            Download(e.id, HeadsetName == "RIFT", e.appid, e.code)
                            alert("Downloading Version " + downloadVersion + " of " + name + ". If the download doesn't start log in on oculus.com")
                        } else {
                            alert("Aborted download")
                        }
                        */
                        document.getElementById("popupContainer").style.visibility = "visible"
                        document.getElementById("popup").innerHTML = `
                        <div style="font-size: 1.3em;">
                            <div>Do you want to Download ${name} version ${downloadVersion}. If the download doesn't start log in on oculus.com</div>
                            <div style="display: flex;">
                                <div class="customButton" onclick="Download(${e.id}, ${HeadsetName == 'RIFT'}, ${e.appid}, ${e.code})">Yes</div>
                                <div class="customButton" style="margin-left: 10px;" onclick="document.getElementById('popupContainer').style.visibility = 'hidden'">No</div>
                            </div>
                        </div>
                        `
                        downloadVersion = ""
                    }
                })
                document.getElementById("versions").innerHTML += finished < required ? "" : (failed ? "<div style='font-size: 24px; text-align: center; flex: 1;'>Request to Oculus failed cached data is being shown.</div>" + RequestFailedError : "")
                if(document.getElementById("versions").innerHTML == "") {
                    document.getElementById("versions").innerHTML = "<div style='font-size: 24px; text-align: center; flex: 1;'>Nothing found" + (failed ? ". Request to Oculus failed and no cached data does exist." : "") + "</div>"
                }
            }

            function DownloadBytes(url) {
                return new Promise((resolve, reject) => {
                    var request = new XMLHttpRequest();
                    request.open('GET', url, false);
                    request.onreadystatechange = (e) => {
                        console.log(request.readyState)
                        if(request.readyState === XMLHttpRequest.DONE) {
                            if (request.status == 200) {
                                resolve(request.response);
                            } else {
                                reject("Something went wrong: " + request.status);
                            }
                        }
                    }
                    request.send(null);
                })
            }

            function Download(id, isRift, appid, versioncode) {
                var link = GetDownloadLink(id)
                if(isRift) {
                    alert("Please download the rift downgrader to downgrade rift apps. I'll redirect you after this message has been closed.")
                    window.open("https://github.com/ComputerElite/Rift-downgrader/releases/latest", "_blank")
                } else {
                    
                        PostRequest(requestUrl, `doc=query ($params: AppBinaryInfoArgs!) { app_binary_info(args: $params) { info { binary { ... on AndroidBinary { id package_name asset_files { edges { node { ... on AssetFile { id file_name metadata asset_file_type uri size is_required iap_item { is_viewer_entitled } } } } } } } } }}&variables={"params":{"app_params":[{"app_id":"${appid}","version_code":"${versioncode}"}]}}&access_token=${access_token}`).then(res => {
                            res.data.app_binary_info.info.forEach(e => {
                                e.binary.asset_files.edges.forEach(e => {
                                    if(e.node.is_required) window.open(e.node.uri, "_blank")
                                })
                            })
                        })
                        window.open(link, "_blank")
                    
                }
            }

            function GetFormatted(element, isRift) {
                return `<a style="font-size: 16px; color: #EEEEEE; text-align: center; display: flex; width: 100%; cursor: pointer;" onclick="Download(${element.id}, ${isRift}, ${element.appid}, ${element.code})" oncontextmenu="return SetupContextMenu(event, '${element.id}', true)" download>
                            <div class="item" onmouseover="UpdateMousePos(event)" onmouseupdate onmouseleave="HideTooltip()" onmouseenter="ShowTooltip(event, 'Version code: ${element.code}<br/>upload date: ${element.createdate ? UnixToDataAndTime(element.createdate) : "N/A"}')">${element.version}</div>
                            <div class="item">${element.changelog == "N/A" ? "Changelog not available" : element.changelog.replace("\n", "<br/>")}</div>
                            <div class="item">${element.id}</div>
                        </a>
                        <div style='width: 90%; margin-left: auto; margin-right: auto;'><hr></div>`
            }

            function GetResultFormatted(element) {
                return `<a class="darken" style="flex: 0; background-color: #22222200; font-size: 18px; padding: 5px; margin: 5px; cursor: pointer; text-align: left;" onclick="SearchVersions('${element.id}')" oncontextmenu="return SetupContextMenu(event, '${element.id}', false);">
                            <table style="width: fit-content; margin: auto;" class="defTextColor">
                                <tr><td><img class="coolimg" src="${element.imgsrc}" onerror="if (this.src != '../../assets/ImageNotAvailable.png') this.src = '../../assets/ImageNotAvailable.png'"></td></tr><tr><td>${element.name}</td></tr>
                            </table>
                        </a>`
            }

            function GetDlcFormatted(element, isRift) {
                return `<a class="zoom defTextColor" style="flex: 1; background-color: #222222; font-size: 18px; padding: 5px; margin: 5px; cursor: pointer;" onclick="Download(${element.id}, ${isRift})" oncontextmenu="return SetupContextMenu(event, '${element.id}', true);">
                            ${element.name}
                        </a>`
            }


            var issueReported = false
            function ReportIssue() {
                if(issueReported) return;
                
                    PostRequest("https://cors-anywhere-computerelite.herokuapp.com/postissue", "").then(res => {
                        console.log(res.msg)
                        alert(res.msg)
                    }).catch(res => {
                        //alert("Reporting to Server failed! It may have stopped working.")
                        console.log("Reporting to Server failed! It may have stopped working.")
                    })
                
                issueReported = true;
                
            }
        </script>
    </body>
</html>
